# Configuration for dev-server (.dev.env)
# TODO: Change .dev.env to .env for production

version: '3'

services:
    python:
        restart: always
        build:
            context: .
            dockerfile: docker/python/Dockerfile
        volumes:
            - .:/srv/www/property-project
        links:
          - postgres:postgres
        expose:
          - 8000
        ports:
            - 8000:8000
#        command: "python manage.py runserver 0.0.0.0:8000"
        env_file:
            - .env
        depends_on:
            - postgres
        stdin_open: true
        tty: true

    postgres:
        image: postgres:13-alpine
        restart: always
        env_file:
            - .env
        ports:
            - "5432:5432"
        environment:
            POSTGRES_DB: "${POSTGRES_DB}"
            POSTGRES_USER: "${POSTGRES_USER}"
            POSTGRES_PASSWORD: "${POSTGRES_PASSWORD}"
        volumes:
            - pgdata:/var/lib/postgresql/data
            - ./logs:/srv/www/property-project/logs

#    rabbitmq:
#        image: rabbitmq:3.8.6-alpine
#        volumes:
##            - ./docker/rabbitmq:/var/lib/rabbitmq
#            - ./logs:/var/log/rabbitmq
#        env_file:
#            - .env
#        ports:
#            - 5672:5672
volumes:
    pgdata:
#    rabbitmqdata:



